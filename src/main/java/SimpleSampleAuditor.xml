<?xml version="1.0" ?>
<!DOCTYPE MBeanType SYSTEM "commo.dtd">

<!-- MBean Definition File (MDF) for the Simple Sample Auditor.

     Copyright (c) 2002 by BEA Systems, Inc.  All Rights Reserved.
-->

<!-- Declare your mbean.

     Since it is for an auditor, it must extend the
     weblogic.management.security.audit.Auditor mbean.

     The Name and DisplayName must be the same.
     They specify the name that will appear on the
     console for this provider.

     Set the PeristPolicy to "OnUpdate" so that if an attribute
     value is changed, the new value is written to disk immediately.
     See the "Developing Security Services" manual for more info.

     Note that since this is an xml document, you can't use double
     quotes directly.  Instead you need to use &quot;

     Note that setting "Writeable" to "false" on an attribute
     makes the attribute read-only.  The default is read-write.

     The Implements for weblogic.management.security.audit.ContextHandler
     indicates the auditor can handle the OPTIONAL attributes that
     indicate the supported and active ContextHandler entries. We also
     supply the SupportedContextHandlerEntries attribute as a readonly
     attribute further below.

-->

<MBeanType
 Name          = "SimpleSampleAuditor"
 DisplayName   = "SimpleSampleAuditor"
 Package       = "examples.security.providers.audit.simple"
 Extends       = "weblogic.management.security.audit.Auditor"
 Implements    = "weblogic.management.security.audit.ContextHandler"
 PersistPolicy = "OnUpdate"
>

 <!-- You must set the value of the ProviderClassName attribute
      (inherited from the weblogic.management.security.Provider mbean)
      to the name of the java class you wrote that implements the
      weblogic.security.spi.AuditProvider interface.

      You can think of the provider's mbean as the factory
      for your provider's runtime implementation.
 -->
 <MBeanAttribute
  Name        = "ProviderClassName"
  Type        = "java.lang.String"
  Writeable   = "false"
  Preprocessor = "weblogic.management.configuration.LegalHelper.checkClassName(value)"
  Default     = "&quot;examples.security.providers.audit.simple.SimpleSampleAuditProviderImpl&quot;"
 />

 <!-- You must set the value of the Description attribute
      (inherited from the weblogic.management.security.Provider mbean)
      to a brief description of your provider.
      It is displayed in the console.
 -->
 <MBeanAttribute
  Name        = "Description"
  Type        = "java.lang.String"
  Writeable   = "false"
  Default     = "&quot;WebLogic Simple Sample Audit Provider&quot;"
 />

 <!-- You must set the value of the Version attribute
      (inherited from the weblogic.management.security.Provider mbean)
      to your provider's version.  There is no required format.
 -->
 <MBeanAttribute
  Name        = "Version"
  Type        = "java.lang.String"
  Writeable   = "false"
  Default     = "&quot;1.0&quot;"
 />

 <!-- This provider implements the OPTIONAL weblogic.management.security.audit.ContextHandler
      interface, so the provider should supply the list of ContextHandler entries that i
      can support.
      The supported entries are supplied as a readonly array of String values.
      TBD: See docs about the "Dictionary..."
    
 -->

 <MBeanAttribute
  Name          = "SupportedContextHandlerEntries"
  Type          = "java.lang.String[]"
  Writeable     = "false"
  Default       = "new String[] { &quot;com.bea.contextelement.servlet.HttpServletRequest&quot; }"
  Description   = "List of all ContextHandler entries
                     supported by the auditor."
 />

 <!-- Add any custom attributes for your provider here.

      The simple sample auditor adds a custom attribute named
      LogFileName.  It contains the pathname of the
      file that the simple sample auditor should write its
      audit log to.

      The simple sample auditor's runtime implementation
      (SimpleSampleAuditProviderImpl) will read the value
      of this attribute from its mbean.

      Note: custom attributes do not appear in the
      console in WLS 7.0.  Use the admin command line tool
      (java weblogic.Admin) to view and set their values.
      See build.xml for the syntax for setting the
      LogFileName attribute.

      Refer to the "Developing Security Services" manual
      for more info on defining custom attributes.
 -->
 <MBeanAttribute
  Name        = "LogFileName"
  Type        = "java.lang.String"
  Default     = "&quot;SimpleSampleAuditor.log&quot;"
 />


</MBeanType>
